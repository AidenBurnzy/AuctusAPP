# ğŸ¯ JWT Implementation - Visual Architecture

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           YOUR AUCTUS APP                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ FRONTEND (Browser)                                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  index.html                                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Role Selection (Admin/Employee)                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Admin Login Modal â”€â”€â†’ checkAdminPassword()                  â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Admin Panel                                                  â”‚   â”‚
â”‚  â”‚      â”œâ”€â”€ Clients â”€â”€â”€â”€â†’ storage.js.getClients()                 â”‚   â”‚
â”‚  â”‚      â”œâ”€â”€ Projects â”€â”€â”€â†’ storage.js.getProjects()                â”‚   â”‚
â”‚  â”‚      â”œâ”€â”€ Finances â”€â”€â”€â†’ storage.js.getFinances()                â”‚   â”‚
â”‚  â”‚      â””â”€â”€ ... etc                                                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  localStorage:                                                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€ auctus_auth_token: "eyJhbGc..." â† JWT Token                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                                         â”‚                          â”‚
â”‚         â”‚ (1) Password                            â”‚ (3) API Requests        â”‚
â”‚         â”‚     POST /auth                          â”‚     GET /clients         â”‚
â”‚         â”‚     { password: "..." }                 â”‚     POST /projects       â”‚
â”‚         â†“                                         â†“                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ NETLIFY FUNCTIONS BACKEND                                          â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  (2) Returns      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ /auth                    â”‚  JWT Token        â”‚ All Endpoints: â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ auth.js                  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ - validateTokenâ”‚ â”‚   â”‚
â”‚  â”‚  â”‚                          â”‚                   â”‚ - Parse body   â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ 1. Get password          â”‚                   â”‚ - Query DB     â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ 2. Compare ADMIN_PASS envâ”‚                   â”‚ - Return data  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚ 3. Sign JWT token        â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”‚ 4. Return token          â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚    (expires in 7 days)   â”‚                       â†“               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         â†‘                                        â”‚ auth-helper.js   â”‚   â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚                  â”‚   â”‚
â”‚  â”‚              ENV Variables:                     â”‚ 1. Extract token â”‚   â”‚
â”‚  â”‚              - ADMIN_PASSWORD                   â”‚ 2. Verify JWT    â”‚   â”‚
â”‚  â”‚              - JWT_SECRET                       â”‚ 3. Check expiry  â”‚   â”‚
â”‚  â”‚              - ALLOWED_ORIGINS                  â”‚ 4. Return decodedâ”‚   â”‚
â”‚  â”‚                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚                                                         â†“              â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  (4) Protected Data    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  â”‚ /clients                 â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ PostgreSQL DB   â”‚
â”‚  â”‚  â”‚ /projects                â”‚                        â”‚ (Neon)          â”‚
â”‚  â”‚  â”‚ /websites                â”‚                        â”‚                 â”‚
â”‚  â”‚  â”‚ /ideas                   â”‚     SELECT * FROM      â”‚ - clients       â”‚
â”‚  â”‚  â”‚ /finances                â”‚     WHERE id = ?        â”‚ - projects      â”‚
â”‚  â”‚  â”‚ /subscriptions           â”‚                        â”‚ - websites      â”‚
â”‚  â”‚  â”‚ /recurring-income        â”‚                        â”‚ - finances      â”‚
â”‚  â”‚  â”‚ /allocations             â”‚                        â”‚ - ... etc       â”‚
â”‚  â”‚  â”‚ /employees               â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚  â”‚ /notes                   â”‚
â”‚  â”‚  â”‚ /admin                   â”‚
â”‚  â”‚  â”‚ /users                   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â”‚
â”‚  â”‚  ALL ENDPOINTS:
â”‚  â”‚  âœ… Check token with auth-helper
â”‚  â”‚  âœ… Return 401 if invalid
â”‚  â”‚  âœ… Proceed with operation if valid
â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Request Flow Diagram

### LOGIN REQUEST
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Browser   â”‚
â”‚   User      â”‚
â”‚ clicks      â”‚
â”‚ "Admin"     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Shows admin login modal           â”‚
â”‚ User enters password              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ app.js: checkAdminPassword(password)                 â”‚
â”‚ Sends: POST /.netlify/functions/auth                 â”‚
â”‚        { password: "YourPassword123" }               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ auth.js (Backend)                                    â”‚
â”‚ 1. Extract password from request                     â”‚
â”‚ 2. Compare with env var ADMIN_PASSWORD               â”‚
â”‚ 3. If match: jwt.sign(data, JWT_SECRET, 7d)         â”‚
â”‚    If no match: return 401 error                     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response: { token: "eyJhbGc..." }                    â”‚
â”‚ OR Error: { error: "Invalid credentials" }           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend:                                            â”‚
â”‚ localStorage.setItem('auctus_auth_token', token)     â”‚
â”‚ Redirect to admin panel                              â”‚
â”‚ âœ… Login complete!                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DATA REQUEST (After Login)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend wants to fetch clients                                 â”‚
â”‚ Calls: await storage.getClients()                              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ storage.js: apiRequest('clients', 'GET')                        â”‚
â”‚                                                                  â”‚
â”‚ Reads token from localStorage:                                  â”‚
â”‚ token = localStorage.getItem('auctus_auth_token')               â”‚
â”‚                                                                  â”‚
â”‚ Adds to headers:                                                â”‚
â”‚ headers['Authorization'] = 'Bearer ' + token                    â”‚
â”‚                                                                  â”‚
â”‚ Sends: GET /.netlify/functions/clients                         â”‚
â”‚        Headers: { Authorization: "Bearer eyJhbGc..." }         â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend (clients.js):                                            â”‚
â”‚                                                                  â”‚
â”‚ 1. Receive request with Authorization header                    â”‚
â”‚ 2. Call: validateToken(event) from auth-helper.js              â”‚
â”‚                                                                  â”‚
â”‚ auth-helper.js does:                                            â”‚
â”‚ - Extract "Bearer eyJhbGc..." from header                      â”‚
â”‚ - Remove "Bearer " prefix                                       â”‚
â”‚ - jwt.verify(token, JWT_SECRET)                                 â”‚
â”‚ - If valid: return decoded token { role: 'admin', ... }       â”‚
â”‚ - If invalid: throw error                                       â”‚
â”‚                                                                  â”‚
â”‚ 3. If validateToken throws error:                              â”‚
â”‚    return { statusCode: 401, body: "Unauthorized" }           â”‚
â”‚                                                                  â”‚
â”‚ 4. If validateToken succeeds:                                  â”‚
â”‚    Proceed to query database:                                   â”‚
â”‚    SELECT * FROM clients ORDER BY name ASC                     â”‚
â”‚    return { statusCode: 200, body: [...clients] }              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend receives response:                                      â”‚
â”‚ 200 OK with client data: [{id: 1, name: "..."}, ...]           â”‚
â”‚ OR 401 Unauthorized (if token invalid/expired)                  â”‚
â”‚                                                                  â”‚
â”‚ If 401: User must login again                                   â”‚
â”‚ If 200: Data displayed in UI âœ…                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Environment Variable Configuration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Netlify Environment Variables                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚ JWT_SECRET                                                      â”‚
â”‚ â”œâ”€ Purpose: Sign JWT tokens                                   â”‚
â”‚ â”œâ”€ Value: Random 32-byte hex string                           â”‚
â”‚ â”œâ”€ Generate: openssl rand -hex 32                             â”‚
â”‚ â”œâ”€ Example: 3d8b4c2f9e1a7d6b5c4a9f2e8d1c3b7a                â”‚
â”‚ â””â”€ Security: Keep secret âš ï¸                                    â”‚
â”‚                                                                  â”‚
â”‚ ADMIN_PASSWORD                                                  â”‚
â”‚ â”œâ”€ Purpose: Authenticate admin login                          â”‚
â”‚ â”œâ”€ Value: Strong password                                      â”‚
â”‚ â”œâ”€ Example: AuctusSecure2024!                                 â”‚
â”‚ â””â”€ Security: Keep secret âš ï¸                                    â”‚
â”‚                                                                  â”‚
â”‚ ALLOWED_ORIGINS                                                â”‚
â”‚ â”œâ”€ Purpose: CORS - which domains can access API               â”‚
â”‚ â”œâ”€ Value: Your app URL(s)                                     â”‚
â”‚ â”œâ”€ Example: https://auctusventures.netlify.app               â”‚
â”‚ â”œâ”€ Multiple: https://app.com,https://backup.com              â”‚
â”‚ â””â”€ Security: Restrict to your domains âš ï¸                       â”‚
â”‚                                                                  â”‚
â”‚ DEBUG (Optional)                                               â”‚
â”‚ â”œâ”€ Purpose: Show detailed errors                              â”‚
â”‚ â”œâ”€ Value: true or false                                       â”‚
â”‚ â”œâ”€ Default: false (production)                                â”‚
â”‚ â””â”€ Note: Set true only for troubleshooting                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER              â”‚
â”‚  Enters password    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â†’ FRONTEND (app.js)
           â”‚   â””â”€â†’ POST /auth endpoint
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AUTH ENDPOINT      â”‚
â”‚  auth.js            â”‚
â”‚  Validates password â”‚
â”‚  Generates JWT      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â†’ Returns token
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND           â”‚
â”‚  Stores in storage  â”‚
â”‚  Adds to header     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â†’ All future API calls
           â”‚   with Authorization header
           â”‚
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API ENDPOINT       â”‚
â”‚  (clients, projects â”‚
â”‚   websites, etc)    â”‚
â”‚  auth-helper.js     â”‚
â”‚  Validates token    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â†’ Success: Proceed
           â”‚   Return data
           â”‚
           â””â”€â†’ Failure: 401
               Request re-login
```

## Timeline of a User Session

```
T=0:00 - User opens app
T=0:05 - Clicks "Admin Access" button
T=0:10 - Enters password
T=0:15 - Frontend sends POST /auth
T=0:20 - Backend validates and returns token (24hr TTL)
T=0:25 - Frontend stores in localStorage âœ…
T=0:30 - Admin panel loads
T=0:35 - User clicks "View Clients"
T=0:40 - Frontend requests GET /clients with token header
T=0:45 - Backend validates token âœ… â†’ Queries DB
T=0:50 - Client data returned and displayed
...
T=7d:00 - Token expires (auto re-login needed)
T=7d:05 - User clicks something, gets 401
T=7d:10 - Redirected to login (need to re-enter password)
T=7d:15 - New token issued, session continues
```

## Security Comparison

```
BEFORE JWT:                    AFTER JWT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Password in code       âŒ     No passwords in code    âœ…
Always visible         âŒ     Token in localStorage   âœ…
No expiration          âŒ     7-day token exp         âœ…
Open CORS              âŒ     Restricted CORS         âœ…
No per-request auth    âŒ     Auth on every request   âœ…
Info leak in errors    âŒ     Generic errors          âœ…
Loose equality         âŒ     Strict equality         âœ…

Security Level:
BEFORE: â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20%         AFTER: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 95%
```

---

This architecture ensures that:
- Your password is never exposed to the internet
- Every API request is authenticated
- Tokens expire to limit exposure
- CORS prevents unauthorized domain access
- All data is protected behind authentication
